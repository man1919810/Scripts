local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")

local Translations = {
   ["mshax v4.5 | DOORS "] = "mshax v4.5 | DOORS(🇨🇳)",
    ["Main"] = "主要",
    ["Miscellaneous"] = "杂项",
    ["Notifying / ESP"] = "通知/透视",
    ["Instant Interacts"] = "即时互动",
    ["Prompt Clip"] = "隔墙互动",
    ["Disable AFK"] = "防挂机踢出",
    ["Anti Lag"] = "防卡顿",
    ["No Cutscenes"] = "无过场动画",
    ["Reset"] = "重置",
    ["Play Again"] = "重新开始",
    ["Lobby"] = "回大厅",
    ["Revive"] = "复活(非免费)",
    ["Reach"] = "范围",
    ["Prompt Reach"] = "互动范围扩大",
    ["Door Reach"] = "开门范围扩大",
    ["Door Reach Range"] = "开门范围",
    ["Entities"] = "实体",
    ["Entity Notifys"] = "实体通知",
    ["Entities ESP"] = "实体透视",
    ["Notify Library Code"] = "通知图书馆密码",
    ["Player"] = "玩家",
    ["Movement"] = "移动",
    ["Camera"] = "相机",
    ["Speed Boost Slider"] = "速度调节",
    ["Speed Boost"] = "启用速度",
    ["Noclip"] = "穿墙",
    ["Enable Jump"] = "启用跳跃",
    ["Infinite Jump"] = "无限跳",
    ["No Acceleration"] = "无加速度",
    ["No Closet Exit Delay"] = "快速出柜",
    ["Fly Speed"] = "飞行速度调节",
    ["Fly"] = "启用飞行",
    ["Infinite Items"] = "无限物品",
    ["Infinite Crucifixs"] = "无限十字架",
    ["Infinite LockPicks"] = "无限撬锁器",
    ["Infinite Shears"] = "无限剪刀",
    ["Fullbright"] = "提高亮度",
    ["No Camera Shake"] = "无视角抖动",
    ["Third Person"] = "第三人称",
    ["Spectate Entity"] = "窥视实体",
    ["FOV Slider"] = "视距调节",
    ["FOV"] = "启用视距",
    ["Exploits"] = "功能",
    ["Entitys"] = "实体",
    ["Bypass"] = "绕过",
    ["Anti-Dread"] = "防Dread",
    ["Anti-Screech"] = "防Screech",
    ["Anti-A90"] = "防A90",
    ["Anti-Eyes"] = "防Eyes",
    ["Anti-Snare"] = "防地刺",
    ["Anti-Dupe"] = "防假门",
    ["Anti-Figure-Hearing"] = "移除Figure听力",
    ["Anti-Halt"] = "防Halt",
    ["Speed Bypass"] = "速度绕过",
    ["Godmode Dropdown"] = "无敌模式",
    ["Toggle"] = "切换",
    ["Automation"] = "自动化",
    ["God Mode"] = "启用无敌模式",
    ["Anti Cheat Manipulation"] = "反作弊操控",
    ["Auto Interact"] = "自动互动",
    ["Ignore List"] = "忽略对象",
    ["Auto Heartbeat Minigame"] = "自动心跳小游戏",
    ["Unlock Padlock Distance"] = "自动挂锁距离",
    ["Automation Library Code"] = "自动图书馆密码",
    ["Auto Breaker Box"] = "自动电箱游戏",
    ["Auto Closet"] = "自动躲柜子",
    ["Visuals"] = "视觉",
    ["Settings"] = "设置",   
    ["Enable Show Distances"] = "启用显示距离",
    ["Transparent"] = "透明",
    ["Transparency Slider"] = "透明度",
    ["Transparency Closet"] = "透明柜子",
    ["Transparency Cart"] = "透明矿车",
    ["Esp"] = "透视",
    ["Door"] = "门",
    ["Key"] = "钥匙",
    ["Closet ESP"] = "柜子",
    ["Gate Lever"] = "铁门拉杆",
    ["Players ESP"] = "玩家",
    ["Books"] = "书",
    ["Breaker"] = "电箱",
    ["Items ESP"] = "道具",
    ["Gold ESP"] = "金币",
    ["Gold"] = "金币",
    ["Candle"] = "蜡烛",
    ["Bed"] = "床",
    ["Bandage"] = "绷带",
    ["Pick"] = "器",
    ["Chest"] = "箱子",
    ["Locked"] = "上锁的",
    ["Jeff Tip"] = "Jeff小费罐",
    ["Flash Light"] = "手电筒",
    ["Battery"] = "电池",
    ["Smoothie"] = "冰沙",
    ["Crucifix"] = "十字架",
    ["Alarm Clock"] = "闹钟",
    ["No Footer"] = "mshax | doors魔怔人",
    ["Floor"] = "楼层",
    ["Entites Bypass"] = "实体绕过",
    ["Auto Doors (99 Doors)"] = "自动通关(到99门)",
    ["Anti Nanner Banana"] = "防香蕉滑倒",
    ["Anti Seek-0bstructions"] = "防seek障碍物",
    ["Modifiers"] = "修饰符",
    ["Death Farm"] = "自动刷死亡数",
    ["Anti Lookman"] = "防Lookman",
    ["Anti Fog"] = "去除雾",
    ["Anti Giggle"] = "防Giggle",
    ["Anti Jamming"] = "去除Jeff音乐",
    ["Anti Gloom Egg"] = "防苍蝇蛋",
    ["Anti Vacuum"] = "防虚空门",
    ["ESP"] = "透视",
    ["Timer Lever ESP"] = "计时器拉杆",
    ["Search"] = "搜索脚本功能",
    ["Config"] = "配置",
    ["Themes"] = "主题",
    ["Background color"] = "背景颜色",
    ["Main color"] = "主要颜色",
    ["Accent color"] = "强调色",
    ["Outline color"] = "轮廓颜色",
    ["Font color"] = "字体颜色",
    ["Font Face"] = "字体样式", 
    ["Custom themes"] = "自定义主题",
    ["Theme list"] = "主题列表",
    ["Default"] = "默认",
    ["Fatality"] = "死亡",
    ["Jester"] = "小丑",
    ["Mint"] = "薄荷",
    ["Tokyo Night"] = "东京之夜",
    ["Quartz"] = "石英",
    ["Set as default"] = "设置为默认",
    ["Custom theme name"] = "自定义主题名称",
    ["Create theme"] = "创建主题",
    ["Load theme"] = "加载主题",
    ["Overwrite theme"] = "覆盖主题",
    ["Delete theme"] = "删除主题",
    ["Refresh list"] = "刷新列表",
    ["Reset default"] = "重置默认",
    ["UI"] = "用户界面",
    ["Fps Unlocker"] = "FPS解锁",
    ["Play Sound"] = "播放声音",
    ["Notify Side"] = "通知消息位置",
    ["Right"] = "右边",
    ["Left"] = "左边",
    ["Menu bind"] = "菜单绑定",
    ["Show Keybinds"] = "显示功能绑定",
    ["Show Custom Cursor"] = "显示自定义光标",
    ["Unload GUI"] = "卸载GUI",
    ["Join Discord"] = "加入Discord",
    ["Credits"] = "制作人员",
    ["KardinCat - Creator"] = "脚本原作者:KardinCat",
    ["notzanocoddz - W Guy Made Auto Load Config"] = "由doors魔怔人汉化",
    ["Configuration"] = "预设",
    ["Config name"] = "预设名称",
    ["Create config"] = "创建预设",
    ["Config list"] = "预设列表",
    ["Load config"] = "加载预设",
    ["Overwrite config"] = "覆盖预设",
    ["Delete config"] = "删除预设",
    ["Reset autoload"] = "重置自动加载",
    ["Current autoload config: Doors"] = "当前自动加载预设：Doors",
    ["Addons"] = "附加组件",
    ["Failed to load autoload config"] = "无法加载自动加载预设",
    ["Loading Mshax"] = "加载mshax汉化",
}

local function translateText(text)
    if not text or type(text) ~= "string" then return text end
    
    if Translations[text] then
        return Translations[text]
    end
    
    for en, cn in pairs(Translations) do
        if text:find(en) then
            return text:gsub(en, cn)
        end
    end
    
    return text
end

local function setupTranslationEngine()
    local success, err = pcall(function()
        local oldIndex = getrawmetatable(game).__newindex
        setreadonly(getrawmetatable(game), false)
        
        getrawmetatable(game).__newindex = newcclosure(function(t, k, v)
            if (t:IsA("TextLabel") or t:IsA("TextButton") or t:IsA("TextBox")) and k == "Text" then
                v = translateText(tostring(v))
            end
            return oldIndex(t, k, v)
        end)
        
        setreadonly(getrawmetatable(game), true)
    end)
    
    if not success then
        warn("元表劫持失败:", err)
       
        local translated = {}
        local function scanAndTranslate()
            for _, gui in ipairs(game:GetService("CoreGui"):GetDescendants()) do
                if (gui:IsA("TextLabel") or gui:IsA("TextButton") or gui:IsA("TextBox")) and not translated[gui] then
                    pcall(function()
                        local text = gui.Text
                        if text and text ~= "" then
                            local translatedText = translateText(text)
                            if translatedText ~= text then
                                gui.Text = translatedText
                                translated[gui] = true
                            end
                        end
                    end)
                end
            end
            
            local player = game:GetService("Players").LocalPlayer
            if player and player:FindFirstChild("PlayerGui") then
                for _, gui in ipairs(player.PlayerGui:GetDescendants()) do
                    if (gui:IsA("TextLabel") or gui:IsA("TextButton") or gui:IsA("TextBox")) and not translated[gui] then
                        pcall(function()
                            local text = gui.Text
                            if text and text ~= "" then
                                local translatedText = translateText(text)
                                if translatedText ~= text then
                                    gui.Text = translatedText
                                    translated[gui] = true
                                end
                            end
                        end)
                    end
                end
            end
        end
        
        local function setupDescendantListener(parent)
            parent.DescendantAdded:Connect(function(descendant)
                if descendant:IsA("TextLabel") or descendant:IsA("TextButton") or descendant:IsA("TextBox") then
                    task.wait(0.1)
                    pcall(function()
                        local text = descendant.Text
                        if text and text ~= "" then
                            local translatedText = translateText(text)
                            if translatedText ~= text then
                                descendant.Text = translatedText
                            end
                        end
                    end)
                end
            end)
        end
        
        pcall(setupDescendantListener, game:GetService("CoreGui"))
        local player = game:GetService("Players").LocalPlayer
        if player and player:FindFirstChild("PlayerGui") then
            pcall(setupDescendantListener, player.PlayerGui)
        end
        
        while true do
            scanAndTranslate()
            task.wait(3)
        end
    end
end

task.wait(2)

setupTranslationEngine()

local success, err = pcall(function()
--这下面填加载外部脚本
loadstring(game:HttpGet("https://raw.githubusercontent.com/TheHunterSolo1/Op-Ninja-Simulator-/Main/Lua"))()


end)

if not success then
    warn("加载失败:", err)
end
